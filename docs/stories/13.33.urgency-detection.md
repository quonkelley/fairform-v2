# Story 13.33: Case Type-Specific Urgency Detection ⚠️

## Status
📋 Planned

## Story
**As a** user with a time-sensitive legal issue,
**I want** the system to detect urgency and warn me,
**so that** I take immediate action and don't miss critical deadlines.

## Acceptance Criteria

1. Detects urgent time phrases ("tomorrow", "3 days", "this week")
2. Shows red alert banner for evictions with <7 days to hearing
3. Prioritizes urgent cases in system processing
4. Suggests immediate actions for urgent cases
5. Different urgency levels (critical, high, normal)
6. Works across case types with type-specific thresholds
7. Clear, non-alarming language (helpful, not scary)
8. Mobile-optimized urgent banners

## Tasks / Subtasks

- [ ] Task 1: Create urgency detection logic (AC: 1, 5, 6)
  - [ ] Create `lib/ai/urgencyDetection.ts`
  - [ ] Parse time expressions
  - [ ] Calculate days until deadline
  - [ ] Assign urgency levels
  - [ ] Case-type-specific thresholds

- [ ] Task 2: UI for urgent warnings (AC: 2, 7, 8)
  - [ ] Create UrgentBanner component
  - [ ] Red alert styling
  - [ ] Clear action items
  - [ ] Mobile-optimized

- [ ] Task 3: Immediate action suggestions (AC: 4)
  - [ ] Generate urgent next steps
  - [ ] Link to relevant resources
  - [ ] One-click actions

- [ ] Task 4: Priority handling (AC: 3)
  - [ ] Flag urgent cases in database
  - [ ] Priority queue for support
  - [ ] Email alerts for urgent cases

- [ ] Task 5: Testing (AC: All)
  - [ ] Test with various time expressions
  - [ ] Test urgency thresholds
  - [ ] Test across case types
  - [ ] User testing for language/tone

## Dev Notes

### Urgency Detection

```typescript
export function detectUrgency(
  caseType: string,
  hearingDate?: string,
  message?: string
): UrgencyLevel {
  // Calculate days until hearing
  const daysUntilHearing = calculateDays(hearingDate);

  // Eviction-specific
  if (caseType === 'eviction') {
    if (daysUntilHearing <= 3) return 'critical';
    if (daysUntilHearing <= 7) return 'high';
  }

  // Parse message for urgency keywords
  if (message) {
    if (/tomorrow|today|asap/.test(message)) return 'high';
    if (/this week|few days/.test(message)) return 'medium';
  }

  return 'normal';
}
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-16 | 1.0 | Initial story creation | Product Team |


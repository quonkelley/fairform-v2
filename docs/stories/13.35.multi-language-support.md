# Story 13.35: Multi-Language Support

## Status
ğŸ“‹ Planned

## Story
**As a** non-English speaking user,
**I want** to use the AI Copilot in my native language,
**so that** I can access legal help without language barriers.

## Acceptance Criteria

1. Auto-detects user language from first message
2. Supports Spanish, Chinese (Simplified), Vietnamese, Arabic initially
3. AI responds in user's detected language
4. Extracts information accurately from non-English input
5. Language selector available in UI to manually switch
6. All UI text (buttons, labels) translated
7. Works with existing case creation flow
8. Fallback to English if unsupported language detected

## Tasks / Subtasks

- [ ] Task 1: Language detection (AC: 1, 8)
  - [ ] Use OpenAI to detect language
  - [ ] Store detected language in session
  - [ ] Fallback logic

- [ ] Task 2: Multi-language responses (AC: 2, 3)
  - [ ] Update system prompt with language instruction
  - [ ] Test responses in each language
  - [ ] Ensure natural translations

- [ ] Task 3: Information extraction (AC: 4)
  - [ ] Extract from non-English messages
  - [ ] Normalize to English for database
  - [ ] Handle language-specific formats (dates, addresses)

- [ ] Task 4: UI translations (AC: 5, 6)
  - [ ] Language selector component
  - [ ] Translate all UI strings
  - [ ] Use i18n library (next-i18next or similar)

- [ ] Task 5: Testing with native speakers (AC: All)
  - [ ] Test each supported language
  - [ ] Verify accuracy and naturalness
  - [ ] User testing with native speakers

## Dev Notes

### Language Detection

```typescript
async function detectLanguage(message: string): Promise<string> {
  const response = await openai.chat.completions.create({
    model: "gpt-4o-mini",
    messages: [{
      role: "user",
      content: `Detect the language of this message and respond with only the ISO 639-1 code (e.g., "en", "es", "zh"): "${message}"`
    }]
  });

  return response.choices[0].message.content.trim();
}
```

### Multi-Language System Prompt

```typescript
function buildSystemPrompt(language: string = 'en') {
  const languageInstructions = {
    es: "Respond in Spanish. Be warm and helpful.",
    zh: "ç”¨ç®€ä½“ä¸­æ–‡å›å¤ã€‚è¦æ¸©æš–å’Œæœ‰å¸®åŠ©ã€‚",
    vi: "Tráº£ lá»i báº±ng tiáº¿ng Viá»‡t. HÃ£y áº¥m Ã¡p vÃ  há»¯u Ã­ch.",
    ar: "Ø§Ù„Ø±Ø¯ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©. ÙƒÙ† Ø¯Ø§ÙØ¦Ù‹Ø§ ÙˆÙ…ÙÙŠØ¯Ù‹Ø§."
  };

  return `${basePrompt}

${languageInstructions[language] || "Respond in English."}`;
}
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-16 | 1.0 | Initial story creation | Product Team |

